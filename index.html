<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ä¸“å±å¹¸è¿è½¬ç›˜ ğŸ’–</title>
<style>
  :root{
    --wheelSize: 360px;
    --border: 12px;
    --pink:#fb7185;
    --hot:#ff3d9a;
    --gold:#fbbf24;
    --mint:#22c55e;
    --sky:#60a5fa;
    --ink:#0b1220;
    --glass: rgba(255,255,255,.18);
  }

  *{box-sizing:border-box}
  body{
    margin:0; overflow:hidden;
    font-family:-apple-system,BlinkMacSystemFont,"PingFang SC","Microsoft YaHei",system-ui,Arial,sans-serif;
    color:#fff;
    background:
      radial-gradient(900px 650px at 20% 20%, rgba(96,165,250,.35), transparent 60%),
      radial-gradient(900px 650px at 80% 25%, rgba(34,197,94,.28), transparent 60%),
      radial-gradient(900px 650px at 60% 80%, rgba(251,113,133,.35), transparent 60%),
      linear-gradient(135deg, #ff9a9e, #fad0c4);
    text-align:center;
  }

  /* èƒŒæ™¯æµå…‰ */
  .blob{
    position:fixed; inset:auto;
    width:520px; height:520px; border-radius:50%;
    filter: blur(40px);
    opacity:.45;
    animation: drift 14s ease-in-out infinite;
    pointer-events:none;
  }
  .b1{ left:-120px; top:-150px; background: radial-gradient(circle at 30% 30%, rgba(96,165,250,.9), transparent 60%); }
  .b2{ right:-160px; top:40px; background: radial-gradient(circle at 30% 30%, rgba(34,197,94,.8), transparent 60%); animation-duration: 16s;}
  .b3{ left:120px; bottom:-200px; background: radial-gradient(circle at 30% 30%, rgba(251,113,133,.85), transparent 60%); animation-duration: 18s;}
  @keyframes drift{
    0%,100%{ transform: translate(0,0) scale(1); }
    50%{ transform: translate(60px, 40px) scale(1.06); }
  }

  h1{
    margin:20px 12px 6px;
    font-size:24px;
    letter-spacing:.6px;
    text-shadow: 0 10px 30px rgba(0,0,0,.25);
  }
  .sub{
    margin:0 16px 16px;
    color: rgba(255,255,255,.85);
    font-size:14px;
    line-height:1.6;
    text-shadow: 0 10px 30px rgba(0,0,0,.15);
  }
  .badgeRow{
    display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
    margin-bottom:14px;
  }
  .badge{
    padding:7px 12px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.35);
    background: rgba(255,255,255,.18);
    backdrop-filter: blur(10px);
    font-size:12px;
    box-shadow: 0 10px 30px rgba(0,0,0,.12);
    user-select:none;
  }

  .wrap{
    display:flex;
    flex-direction:column;
    align-items:center;
    gap:14px;
    padding-bottom:16px;
  }

  /* æŒ‡é’ˆ */
  .pointer{
    position:relative;
    width:0;height:0;
    border-left:16px solid transparent;
    border-right:16px solid transparent;
    border-bottom:36px solid rgba(255,255,255,.95);
    filter: drop-shadow(0 10px 14px rgba(0,0,0,.28));
    z-index:15;
  }
  .pointer::after{
    content:"";
    position:absolute;
    left:-8px; top:31px;
    width:16px; height:16px;
    background:rgba(255,255,255,.95);
    border-radius:999px;
    box-shadow: 0 10px 24px rgba(0,0,0,.18);
  }

  /* å¤–å£³ */
  .wheelShell{
    width: var(--wheelSize);
    height: var(--wheelSize);
    border-radius:50%;
    border: var(--border) solid rgba(255,255,255,.95);
    position:relative;
    overflow:hidden;
    box-shadow:
      0 24px 80px rgba(0,0,0,.25),
      0 0 0 6px rgba(255,255,255,.20),
      0 0 35px rgba(255,255,255,.55);
    background: rgba(255,255,255,.08);
    backdrop-filter: blur(12px);
  }

  /* æ—‹è½¬å±‚ */
  #wheel{
    position:absolute; inset:0;
    border-radius:50%;
    transition: transform 4.8s cubic-bezier(.2,1,.25,1);
    /* 10æ ¼ */
    background: conic-gradient(
      #d1d5db 0deg 36deg,
      #e5e7eb 36deg 72deg,
      #d1d5db 72deg 108deg,
      #e5e7eb 108deg 144deg,
      #d1d5db 144deg 180deg,
      #e5e7eb 180deg 216deg,
      rgba(255,159,243,.95) 216deg 252deg,
      rgba(254,202,87,.95) 252deg 288deg,
      rgba(72,219,251,.95) 288deg 324deg,
      rgba(255,107,107,.95) 324deg 360deg
    );
  }

  /* åˆ†å‰²çº¿ï¼šä» 12 ç‚¹æ–¹å‘å¼€å§‹å¯¹é½ */
  .divider{
    position:absolute; inset:0;
    border-radius:50%;
    pointer-events:none;
    background:
      repeating-conic-gradient(from -90deg,
        rgba(255,255,255,.85) 0deg 1.3deg,
        transparent 1.3deg 36deg
      );
    mix-blend-mode: overlay;
    opacity:.85;
  }

  /* æ ‡ç­¾å±‚è·Ÿéš wheel è½¬ */
  #labels{
    position:absolute; inset:0;
    border-radius:50%;
    pointer-events:none;
  }
  .label{
    position:absolute;
    top:50%; left:50%;
    transform-origin: 0 0;
    font-size:14px;
    font-weight:1000;
    letter-spacing:.2px;
    text-shadow: 0 2px 12px rgba(0,0,0,.35);
    white-space:nowrap;
    user-select:none;
  }
  .label.small{ font-size:13px; }

  /* ä¸­å¿ƒè£…é¥° */
  .hub{
    position:absolute; left:50%; top:50%;
    transform:translate(-50%,-50%);
    width:92px; height:92px;
    border-radius:50%;
    background: radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.75));
    box-shadow: 0 18px 44px rgba(0,0,0,.25);
    display:grid; place-items:center;
    z-index:10;
  }
  .hub .pulse{
    width:78px; height:78px;
    border-radius:50%;
    background: radial-gradient(circle at 30% 30%, rgba(255,61,154,.9), rgba(251,113,133,.75));
    display:grid; place-items:center;
    color:#fff;
    font-weight:1000;
    letter-spacing:.8px;
    box-shadow: 0 0 24px rgba(255,61,154,.55);
    animation: pulse 1.4s ease-in-out infinite;
  }
  @keyframes pulse{
    0%,100%{ transform: scale(1); filter: brightness(1); }
    50%{ transform: scale(1.06); filter: brightness(1.08); }
  }

  /* æŒ‰é’® */
  .btnRow{ display:flex; gap:10px; flex-wrap:wrap; justify-content:center; }
  button{
    border:none;
    border-radius:999px;
    padding:13px 20px;
    font-size:15px;
    font-weight:1000;
    cursor:pointer;
    color:#0b1220;
    background: rgba(255,255,255,.92);
    box-shadow: 0 16px 34px rgba(0,0,0,.18);
    transition: transform .08s ease, filter .2s ease;
  }
  button:active{ transform: translateY(1px); }
  button[disabled]{ cursor:not-allowed; filter: brightness(.85); }

  .primary{
    background: linear-gradient(90deg, rgba(255,255,255,.95), rgba(255,255,255,.80));
  }
  .tiny{
    font-size:13px;
    padding:10px 14px;
    background: rgba(255,255,255,.78);
  }

  /* çŠ¶æ€æ–‡æ¡ˆ */
  #result{
    width:min(520px, 92vw);
    margin-top:6px;
    padding:14px 14px;
    border-radius:18px;
    border:1px solid rgba(255,255,255,.35);
    background: rgba(255,255,255,.18);
    backdrop-filter: blur(10px);
    box-shadow: 0 18px 44px rgba(0,0,0,.12);
    font-size:15px;
    line-height:1.75;
  }
  .winTitle{
    font-size:18px;
    font-weight:1000;
  }

  /* å¼¹çª— */
  #popup{
    display:none;
    position:fixed; inset:0;
    background: rgba(0,0,0,.78);
    justify-content:center; align-items:center;
    padding:18px;
    z-index:99;
  }
  .popupBox{
    width:min(380px, 92vw);
    border-radius:22px;
    border:1px solid rgba(255,255,255,.25);
    background: rgba(255,255,255,.92);
    color:#ff3d9a;
    box-shadow: 0 30px 120px rgba(0,0,0,.35);
    padding:22px 18px 18px;
    position:relative;
    overflow:hidden;
  }
  .popupBox::before{
    content:"";
    position:absolute; inset:-40px;
    background:
      radial-gradient(circle at 20% 30%, rgba(255,61,154,.28), transparent 60%),
      radial-gradient(circle at 80% 20%, rgba(96,165,250,.25), transparent 60%),
      radial-gradient(circle at 60% 90%, rgba(34,197,94,.18), transparent 60%);
    filter: blur(12px);
    opacity:.9;
    pointer-events:none;
  }
  .popupInner{
    position:relative;
    z-index:2;
  }
  .popupBox h2{
    margin:4px 0 12px;
    font-size:18px;
    font-weight:1000;
  }
  .popupHint{
    margin:0 0 14px;
    color:#7c3aed;
    font-weight:900;
    font-size:13px;
  }

  .chooseArea{
    position:relative;
    height:120px; /* ç»™â€œä¸æ„¿æ„â€é€ƒè·‘ç©ºé—´ */
    border-radius:16px;
    background: rgba(255,255,255,.55);
    border:1px dashed rgba(255,61,154,.35);
    overflow:hidden;
  }

  .yesBtn, .noBtn{
    position:absolute;
    border-radius:999px;
    padding:12px 18px;
    font-size:15px;
    font-weight:1000;
    border:none;
    cursor:pointer;
    box-shadow: 0 16px 34px rgba(0,0,0,.12);
    user-select:none;
  }
  .yesBtn{
    left:18px; top:38px;
    background: linear-gradient(90deg, #ff3d9a, #fb7185);
    color:#fff;
  }
  .noBtn{
    left:210px; top:42px;
    background: rgba(17,24,39,.10);
    color:#111827;
    transition: left .16s ease, top .16s ease, transform .16s ease;
  }

  .closeX{
    position:absolute;
    right:10px; top:8px;
    width:34px; height:34px;
    border-radius:999px;
    border:none;
    cursor:pointer;
    background: rgba(0,0,0,.08);
    color:#111827;
    font-weight:1000;
    z-index:5;
  }

  /* çˆ±å¿ƒ/çº¸å±‘ */
  canvas{ position:fixed; inset:0; pointer-events:none; z-index:80; }

  .heart{
    position:fixed;
    top:-12px;
    font-size:20px;
    animation: fall 6s linear infinite;
    pointer-events:none;
    z-index:70;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,.2));
  }
  @keyframes fall{ to{ transform: translateY(110vh); opacity:0; } }

  /* å°æŠ–åŠ¨å¼ºè°ƒ */
  .shake{ animation: shake .22s ease-in-out 2; }
  @keyframes shake{
    0%,100%{ transform: translateX(0); }
    25%{ transform: translateX(-3px); }
    75%{ transform: translateX(3px); }
  }
</style>
</head>

<body>
  <div class="blob b1"></div>
  <div class="blob b2"></div>
  <div class="blob b3"></div>

  <canvas id="fx"></canvas>

  <h1>ä¸“å±å¹¸è¿è½¬ç›˜ ğŸ’–</h1>
  <p class="sub">è½¬ä¸€ä¸‹å°±çŸ¥é“ä½ æœ‰å¤šå¹¸è¿ï¼ˆæç¤ºï¼šæœ¬è½¬ç›˜å¯¹ä½  <b>åçˆ±</b>ï¼‰ã€‚</p>

  <div class="badgeRow">
    <div class="badge">âœ… ä¸­å¥–ç‡ï¼š100%</div>
    <div class="badge">ğŸ† å¿…ä¸­ã€Œè·å¾—æ‰€æœ‰ç¤¼å“ã€</div>
    <div class="badge">ğŸµ è‡ªå¸¦æš§æ˜§BGM</div>
    <div class="badge">ğŸ’ é¢†å–åæœ‰æƒŠå–œ</div>
  </div>

  <div class="wrap">
    <div class="pointer" aria-hidden="true"></div>

    <div class="wheelShell">
      <div id="wheel">
        <div id="labels"></div>
      </div>
      <div class="divider"></div>
      <div class="hub"><div class="pulse">LOVE</div></div>
    </div>

    <div class="btnRow">
      <button class="primary" id="spinBtn">å¼€å§‹æŠ½å¥–</button>
      <button class="tiny" id="musicBtn">å¼€/å…³éŸ³ä¹</button>
    </div>

    <div id="result">
      ç‚¹å‡»ã€Œå¼€å§‹æŠ½å¥–ã€ï½ ä½ ä¼šæ‹¿åˆ°ï¼šğŸ“¸ğŸ¶ğŸŒ¹ï¼ˆè¿˜æœ‰ä¸€ç‚¹ç‚¹å¿ƒåŠ¨ï¼‰ã€‚
    </div>
  </div>

  <!-- æš§æ˜§æµªæ¼«BGMï¼ˆå¯æ¢ï¼‰ -->
  <audio id="bgm" loop>
    <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_5a6fa2e1f3.mp3?filename=romantic-background-112199.mp3" type="audio/mp3">
  </audio>

  <!-- å¼¹çª— -->
  <div id="popup">
    <div class="popupBox">
      <button class="closeX" id="closeX">Ã—</button>
      <div class="popupInner" id="popupInner">
        <h2>ä½ æ„¿æ„åšæˆ‘çš„å¥³æœ‹å‹å—ï¼ŸğŸ’–</h2>
        <div class="popupHint">æç¤ºï¼šä¸æ„¿æ„ä¼šé€ƒè·‘ï¼ˆå®ƒä¹ŸçŸ¥é“ç­”æ¡ˆæ˜¯ä»€ä¹ˆğŸ˜ï¼‰</div>

        <div class="chooseArea" id="chooseArea">
          <button class="yesBtn" id="yesBtn">æ„¿æ„ ğŸ’•</button>
          <button class="noBtn" id="noBtn">ä¸æ„¿æ„ ğŸ™ˆ</button>
        </div>

        <div style="margin-top:12px;color:#111827;font-weight:900;font-size:13px;">
          ä½ ç‚¹ã€Œæ„¿æ„ã€ï¼Œæˆ‘å°±æŠŠæ‰€æœ‰ç¤¼ç‰©éƒ½ç»™ä½ ï¼ˆè¿åŒæˆ‘è‡ªå·±ï¼‰ã€‚
        </div>
      </div>
    </div>
  </div>

<script>
  /**********************
   * 1) è½¬ç›˜æ•°æ®ä¸å¯¹é½
   **********************/
  const prizes = [
    "æ²¡ä¸­å¥–","æ²¡ä¸­å¥–","æ²¡ä¸­å¥–","æ²¡ä¸­å¥–","æ²¡ä¸­å¥–","æ²¡ä¸­å¥–",
    "ğŸ“¸ æ‹ç«‹å¾—","ğŸ¶ çº¿æ¡å°ç‹—","ğŸŒ¹ é²œèŠ±","ğŸ’– è·å¾—æ‰€æœ‰ç¤¼å“"
  ];
  const N = prizes.length;           // 10
  const STEP = 360 / N;              // 36Â°
  const POINTER_AT = -90;            // æŒ‡é’ˆåœ¨12ç‚¹æ–¹å‘ï¼ˆ-90Â°ï¼‰
  const WIN_INDEX = 9;               // æ°¸è¿œä¸­æœ€åä¸€æ ¼

  const wheel  = document.getElementById("wheel");
  const labels = document.getElementById("labels");
  const spinBtn= document.getElementById("spinBtn");
  const result = document.getElementById("result");

  // ç”Ÿæˆæ ‡ç­¾ï¼šæ”¾æ‰‡åŒºä¸­å¿ƒè§’ï¼Œæ—‹å›ä¿æŒæ­£å‘
  const r = 128; // å­—ç¦»ä¸­å¿ƒè·ç¦»ï¼ˆæ›´é å¤–æ›´æ˜¾çœ¼ï¼‰
  prizes.forEach((text,i)=>{
    const centerAngle = POINTER_AT + i*STEP + STEP/2;
    const el = document.createElement("div");
    el.className = "label" + (text.length>=6 ? " small" : "");
    el.textContent = text;

    // æ²¡ä¸­å¥–ç°ï¼Œå…¶ä»–æ·±è‰²æ›´æ¸…æ™°ï¼ˆèƒŒæ™¯æ˜¯æµ…è‰²æ‰‡åŒºï¼‰
    el.style.color = (text==="æ²¡ä¸­å¥–") ? "#6b7280" : "#111827";

    // rotateåˆ°æ‰‡åŒºä¸­å¿ƒ -> æ²¿åŠå¾„å¹³ç§» -> æ—‹å›è®©å­—æ­£ -> å†å±…ä¸­
    el.style.transform =
      `rotate(${centerAngle}deg) translate(${r}px, -10px) rotate(${-centerAngle}deg) translate(-50%, 0)`;

    labels.appendChild(el);
  });

  /**********************
   * 2) éŸ³ä¹æ§åˆ¶
   **********************/
  const bgm = document.getElementById("bgm");
  const musicBtn = document.getElementById("musicBtn");
  let musicOn = true;

  async function playMusic(){
    if(!musicOn) return;
    try{ await bgm.play(); }catch(e){ /* éƒ¨åˆ†æµè§ˆå™¨éœ€ç”¨æˆ·äº¤äº’ï¼Œç‚¹å‡»æŒ‰é’®åé€šå¸¸å¯æ’­ */ }
  }
  function toggleMusic(){
    musicOn = !musicOn;
    if(musicOn){ playMusic(); musicBtn.textContent="å¼€/å…³éŸ³ä¹"; }
    else { bgm.pause(); musicBtn.textContent="éŸ³ä¹å·²å…³"; }
  }
  musicBtn.addEventListener("click", toggleMusic);

  /**********************
   * 3) æŠ½å¥–ï¼ˆå¿…ä¸­ç‰¹ç­‰å¥–ï¼‰
   **********************/
  function computeRotationToLandOn(index){
    // ç›®æ ‡ï¼šæœ€ç»ˆè¯¥æ‰‡åŒºä¸­å¿ƒè§’ + rotation == POINTER_AT (mod 360)
    const winCenter = POINTER_AT + index*STEP + STEP/2;
    const baseRotation = POINTER_AT - winCenter; // ä½¿æ‰‡åŒºä¸­å¿ƒå¯¹é½æŒ‡é’ˆ
    const spins = 9; // å¤šè½¬å‡ åœˆæ›´å¸¦æ„Ÿ
    return spins*360 + baseRotation;
  }

  spinBtn.addEventListener("click", async ()=>{
    spinBtn.disabled = true;
    await playMusic();

    // éšæœºâ€œå‡è£…â€ä¸€ç‚¹ç‚¹ï¼ˆä¸å½±å“æœ€ç»ˆå‘½ä¸­ï¼‰
    const wiggle = (Math.random()*8 - 4); // -4~+4åº¦çš„å°è¯¯å·®ï¼ˆä½†æˆ‘ä»¬ä¼šåŠ åˆ°ç›®æ ‡è§’é‡Œè®©å®ƒä»è½åœ¨æ ¼å­å†…ï¼‰
    const rotation = computeRotationToLandOn(WIN_INDEX) + wiggle;

    result.classList.remove("shake");
    result.innerHTML = "è½¬ç›˜å¯åŠ¨ä¸­â€¦ğŸ’ ä½ çš„å¥½è¿æ­£åœ¨åŠ è½½ä¸­â€¦";

    wheel.style.transform = `rotate(${rotation}deg)`;

    setTimeout(()=>{
      result.classList.add("shake");
      result.innerHTML = `
        <div class="winTitle">ğŸ‰ æ­å–œä½ è·å¾—ï¼š</div>
        ğŸ“¸ æ‹ç«‹å¾— + ğŸ¶ çº¿æ¡å°ç‹— + ğŸŒ¹ é²œèŠ± + ğŸ’– è·å¾—æ‰€æœ‰ç¤¼å“<br><br>
        <button class="tiny" id="claimBtn">ç‚¹å‡»é¢†å–</button>
      `;
      confettiBurst();
      spinBtn.disabled = false;

      document.getElementById("claimBtn").addEventListener("click", ()=>{
        showPopup();
      });
    }, 4900);
  });

  /**********************
   * 4) å¼¹çª— + é€ƒè·‘æŒ‰é’®
   **********************/
  const popup = document.getElementById("popup");
  const closeX= document.getElementById("closeX");
  const yesBtn = document.getElementById("yesBtn");
  const noBtn  = document.getElementById("noBtn");
  const chooseArea = document.getElementById("chooseArea");
  const popupInner = document.getElementById("popupInner");

  function showPopup(){
    popup.style.display = "flex";
    playMusic();
    // è¿›æ¥å…ˆæŠŠâ€œä¸æ„¿æ„â€éšæœºæŒªä¸€ä¸‹ï¼Œå¢åŠ â€œæ´»çš„â€æ„Ÿè§‰
    moveNoBtn(true);
  }
  function hidePopup(){
    popup.style.display = "none";
  }
  closeX.addEventListener("click", hidePopup);
  popup.addEventListener("click", (e)=>{ if(e.target===popup) hidePopup(); });

  function rand(min,max){ return min + Math.random()*(max-min); }

  function moveNoBtn(isFirst=false){
    const pad = 10;
    const areaW = chooseArea.clientWidth;
    const areaH = chooseArea.clientHeight;

    const btnW = noBtn.offsetWidth || 96;
    const btnH = noBtn.offsetHeight || 42;

    // éšæœºä½ç½®ï¼ˆé¿å¼€â€œæ„¿æ„â€é™„è¿‘ï¼Œåˆ«é‡å ï¼‰
    let x, y, tries=0;
    do{
      x = rand(pad, areaW - btnW - pad);
      y = rand(pad, areaH - btnH - pad);
      tries++;
    }while(tries<12 && x < 140 && y > 20 && y < 90); // ç®€å•é¿è®©æ„¿æ„æŒ‰é’®åŒºåŸŸ

    noBtn.style.left = x + "px";
    noBtn.style.top  = y + "px";

    // å°å¹…ç¼©æ”¾æŠ–åŠ¨æ›´æ¬ æ
    noBtn.style.transform = isFirst ? "scale(1)" : `scale(${rand(.92,1.06).toFixed(2)})`;
  }

  // ç”µè„‘ï¼šé è¿‘å°±è·‘
  noBtn.addEventListener("mouseenter", ()=>moveNoBtn(false));
  // æ‰‹æœºï¼šä¸€ç¢°å°±è·‘
  noBtn.addEventListener("touchstart", (e)=>{ e.preventDefault(); moveNoBtn(false); }, {passive:false});

  // ä½ è¦æ›´ç‹ ï¼šé¼ æ ‡åœ¨åŒºåŸŸé‡Œç§»åŠ¨ä¹Ÿä¼šè·‘ï¼ˆæ›´éš¾ç‚¹åˆ°ï¼‰
  chooseArea.addEventListener("mousemove", (e)=>{
    const rect = noBtn.getBoundingClientRect();
    const dx = e.clientX - (rect.left + rect.width/2);
    const dy = e.clientY - (rect.top  + rect.height/2);
    const dist = Math.sqrt(dx*dx + dy*dy);
    if(dist < 90) moveNoBtn(false);
  });

  // ä¸‡ä¸€ç‚¹åˆ°äº†ï¼ˆå‡ ä¹ä¸å¯èƒ½ï¼‰ï¼Œä¹Ÿè®©å®ƒâ€œé‡æ–°é€‰ä¸€æ¬¡â€
  noBtn.addEventListener("click", ()=>{
    popupInner.innerHTML = `
      <h2>ä½ å±…ç„¶ç‚¹åˆ°äº†ï¼ŸğŸ˜³</h2>
      <div class="popupHint">ç³»ç»Ÿåˆ¤å®šï¼šæ— æ•ˆé€‰æ‹©ã€‚è¯·é‡æ–°é€‰ä¸€æ¬¡ ğŸ’–</div>
      <div style="margin-top:10px;color:#111827;font-weight:900;">
        å†ç»™ä½ ä¸€æ¬¡æœºä¼šâ€”â€”è®¤çœŸç‚¹å“¦ã€‚
      </div>
      <div style="margin-top:14px;">
        <button style="padding:12px 18px;border-radius:999px;border:none;font-weight:1000;cursor:pointer;background:linear-gradient(90deg,#ff3d9a,#fb7185);color:#fff;"
          id="againPick">é‡æ–°é€‰æ‹©</button>
      </div>
    `;
    document.getElementById("againPick").addEventListener("click", ()=>{
      // é‡æ–°åŠ è½½åŸå†…å®¹ï¼ˆæœ€ç®€å•ï¼šåˆ·æ–°å¼¹çª—ï¼‰
      location.reload();
    });
  });

  yesBtn.addEventListener("click", ()=>{
    popupInner.innerHTML = `
      <h2>ä»ä»Šå¤©å¼€å§‹ï¼Œä½ å°±æ˜¯æˆ‘çš„å¥³æœ‹å‹äº† ğŸ’•</h2>
      <div style="margin-top:10px;color:#111827;font-weight:1000;line-height:1.7;">
        ä»¥åæ¯ä¸€ä¸ªèŠ‚æ—¥ã€æ¯ä¸€æ¬¡å¼€å¿ƒã€æ¯ä¸€æ¬¡å§”å±ˆï¼Œ<br>
        æˆ‘éƒ½æƒ³ä»¥ç”·æœ‹å‹çš„èº«ä»½é™ªåœ¨ä½ èº«è¾¹ã€‚
      </div>
      <div style="margin-top:14px;color:#7c3aed;font-weight:900;">
        ï¼ˆç¤¼ç‰©æˆ‘å·²ç»å‡†å¤‡å¥½äº†ï¼Œè½®åˆ°ä½ ç‚¹å¤´äº†ğŸ˜ï¼‰
      </div>
      <div style="margin-top:16px;">
        <button style="padding:12px 18px;border-radius:999px;border:none;font-weight:1000;cursor:pointer;background:rgba(17,24,39,.10);color:#111827;"
          onclick="document.getElementById('popup').style.display='none'">æˆ‘çŸ¥é“å•¦ ğŸ¥°</button>
      </div>
    `;
    heartsBurst(90);
    confettiBurst();
  });

  /**********************
   * 5) çº¸å±‘å½©å¸¦ï¼ˆCanvasï¼‰
   **********************/
  const canvas = document.getElementById("fx");
  const ctx = canvas.getContext("2d");
  let W=0,H=0,parts=[],raf=null;

  function resize(){
    W = canvas.width = innerWidth;
    H = canvas.height = innerHeight;
  }
  addEventListener("resize", resize);
  resize();

  function confettiBurst(){
    parts = [];
    for(let i=0;i<180;i++){
      parts.push({
        x: Math.random()*W,
        y: -30 - Math.random()*H*0.2,
        vx: -3 + Math.random()*6,
        vy: 3 + Math.random()*8,
        r: 3 + Math.random()*6,
        rot: Math.random()*Math.PI,
        vr: -0.25 + Math.random()*0.5,
        life: 130 + Math.random()*70
      });
    }
    if(raf) cancelAnimationFrame(raf);
    tick();
  }

  function tick(){
    ctx.clearRect(0,0,W,H);
    for(const p of parts){
      p.x += p.vx;
      p.y += p.vy;
      p.vy *= 1.01;
      p.rot += p.vr;
      p.life -= 1;

      const a = Math.max(0, Math.min(1, p.life/170));
      ctx.save();
      ctx.translate(p.x,p.y);
      ctx.rotate(p.rot);
      ctx.globalAlpha = a;

      const g = ctx.createLinearGradient(-p.r,-p.r,p.r,p.r);
      g.addColorStop(0, "rgba(255,61,154,0.95)");
      g.addColorStop(0.5, "rgba(96,165,250,0.95)");
      g.addColorStop(1, "rgba(34,197,94,0.95)");
      ctx.fillStyle = g;
      ctx.fillRect(-p.r,-p.r,p.r*2,p.r*2);

      ctx.restore();
    }
    parts = parts.filter(p=>p.life>0 && p.y < H+60);
    if(parts.length) raf = requestAnimationFrame(tick);
    else ctx.clearRect(0,0,W,H);
  }

  /**********************
   * 6) çˆ±å¿ƒé›¨
   **********************/
  function heartsBurst(count=60){
    for(let i=0;i<count;i++){
      const h = document.createElement("div");
      h.className="heart";
      h.textContent = ["ğŸ’–","ğŸ’˜","ğŸ’—","ğŸ’","ğŸ’“"][Math.floor(Math.random()*5)];
      h.style.left = (Math.random()*100) + "vw";
      h.style.animationDuration = (3 + Math.random()*3) + "s";
      h.style.fontSize = (16 + Math.random()*14) + "px";
      h.style.opacity = (0.65 + Math.random()*0.35).toFixed(2);
      document.body.appendChild(h);
      setTimeout(()=>h.remove(), 6500);
    }
  }

  // é¡µé¢å¸¸é©»ä¸€ç‚¹ç‚¹çˆ±å¿ƒé£˜è½ï¼ˆè½»å¾®ï¼‰
  setInterval(()=>{ if(Math.random()<0.35) heartsBurst(4); }, 900);
</script>
</body>
</html>
